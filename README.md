# discord-resolver
Сервис для OpenWRT, который выполняет DNS-запросы к серверам Discord, чтобы получить IP-адреса голосовых серверов.
Сам по себе скрипт ничего не сохраняет, а только стучится к серверам.

## Установка

```bash
wget https://github.com/Rocketman21/discord-resolver/archive/refs/heads/main.tar.gz
tar -xzf main
cd discord-resolver-main
chmod +x install.sh
./install.sh && cd .. && rm -rf main discord-resolver-main
```

## Фичи
1. Можно запустить вручную со своими регионами, например чтобы подгрузить дополнительных,
минуя основной список

```bash
/opt/discord-resolver/discord-resolver.sh start russia us-east us-west
```

2. Запускается по расписанию (cron)
3. Следит за nft-сетом - если адресов слишком мало, запускается автоматически
(например адреса слетели после перезагрузки какого-то сервиса, или сет был очищен вручную
4. Следит за переполнением таблицы соединений conntrack и чистит ее
(если этого не делать, из-за большого количества запросов она не успевает очиститься
по таймауту, и пакеты начинают дропаться)
